{% extends "base.html" %}

{% block title %}Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h2>ğŸ” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª</h2>
        <p class="text-muted">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø§</p>
    </div>
    <div class="col-md-4 text-end">
        <a href="{{ url_for('settings.add_role') }}" class="btn btn-success">â• Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ± Ø¬Ø¯ÙŠØ¯</a>
    </div>
</div>

{% if roles %}
<div class="row">
    {% for role in roles %}
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">ğŸ·ï¸ {{ role.name }}</h5>
            </div>
            <div class="card-body">
                {% if role.description %}
                <p class="text-muted">{{ role.description }}</p>
                {% endif %}

                <div class="mb-3">
                    <h6>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:</h6>
                    {% if role.permissions %}
                        <ul class="list-unstyled">
                            {% for perm in role.permissions.split(',') %}
                            <li>
                                <span class="badge bg-light text-dark">
                                    {% if 'view' in perm %}ğŸ‘ï¸ {% elif 'add' in perm %}â• {% elif 'edit' in perm %}âœï¸ {% elif 'delete' in perm %}ğŸ—‘ï¸ {% endif %}
                                    {{ perm.replace('_', ' ') }}
                                </span>
                            </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                    <p class="text-muted"><em>Ø¨Ø¯ÙˆÙ† ØµÙ„Ø§Ø­ÙŠØ§Øª</em></p>
                    {% endif %}
                </div>

                <div class="mb-3">
                    <small class="text-muted">
                        Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: <strong>{{ role.users|length }}</strong>
                    </small>
                </div>

                <div class="d-grid gap-2">
                    <a href="{{ url_for('settings.edit_role', role_id=role.id) }}" class="btn btn-primary btn-sm">âœï¸ ØªØ¹Ø¯ÙŠÙ„</a>
                    {% if role.users|length == 0 %}
                    <form method="POST" action="{{ url_for('settings.delete_role', role_id=role.id) }}" style="display:inline;">
                        <button type="submit" class="btn btn-danger btn-sm w-100" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ±ØŸ')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </form>
                    {% else %}
                    <button class="btn btn-secondary btn-sm" disabled>ğŸ—‘ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­Ø°Ù (Ø¨Ù‡ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†)</button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">
    Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯ÙˆØ§Ø± Ù…Ø­Ø¯Ø¯Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†
</div>
{% endif %}

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card bg-light">
            <div class="card-body">
                <h6 class="card-title">ğŸ“– Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:</h6>
                <ul class="mb-0 small">
                    <li><strong>ğŸ‘ï¸ View:</strong> Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙ‚Ø·</li>
                    <li><strong>â• Add:</strong> Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</li>
                    <li><strong>âœï¸ Edit:</strong> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©</li>
                    <li><strong>ğŸ—‘ï¸ Delete:</strong> Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <a href="{{ url_for('settings.users_management') }}" class="btn btn-info">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</a>
        <a href="{{ url_for('settings.settings') }}" class="btn btn-secondary">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</a>
    </div>
</div>
{% endblock %}
