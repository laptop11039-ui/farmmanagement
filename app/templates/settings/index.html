{% extends "base.html" %}

{% block title %}ุงูุฅุนุฏุงุฏุงุช{% endblock %}

{% block content %}
<h2 class="mb-4">โ๏ธ ุฅุนุฏุงุฏุงุช ุงููููุน</h2>

<!-- ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช -->
<div class="row mb-4">
    <div class="col-md-6">
        <div class="card border-primary">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">๐ฅ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">ุฅุถุงูุฉ ูุชุนุฏูู ูุญุฐู ุงููุณุชุฎุฏููู</p>
                <a href="{{ url_for('settings.users_management') }}" class="btn btn-primary">๐ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</a>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card border-info">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">๐ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">ุฅูุดุงุก ูุชุนุฏูู ุงูุฃุฏูุงุฑ ูุชุนููู ุงูุตูุงุญูุงุช</p>
                <a href="{{ url_for('settings.roles_management') }}" class="btn btn-info">๐ ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ</a>
            </div>
        </div>
    </div>
</div>

<hr>

<div class="card">
    <div class="card-header">
        <h5>ุฅุฏุงุฑุฉ ุฃุตูุงู ุงูููุชุฌุงุช</h5>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <h6>ุฅุถุงูุฉ ุตูู ููุชุฌ ุฌุฏูุฏ</h6>
            <form id="addProductForm" method="POST" action="{{ url_for('settings.add_product_type') }}">
                <div class="input-group">
                    <input type="text" class="form-control" name="name" placeholder="ุงุณู ุงูููุชุฌ" required>
                    <select class="form-select" name="category" required>
                        <option value="">ุงุฎุชุฑ ุงูุชุตููู</option>
                        <option value="ุฏุฑุงู">ุฏุฑุงู</option>
                        <option value="ุชูุงุญ">ุชูุงุญ</option>
                        <option value="ุฎุถุฑูุงุช">ุฎุถุฑูุงุช</option>
                        <option value="ููุงูู">ููุงูู</option>
                        <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                    </select>
                    <button type="submit" class="btn btn-success">ุฅุถุงูุฉ</button>
                </div>
            </form>
        </div>

        <hr>

        <h6>ุงูุฃุตูุงู ุงูููุฌูุฏุฉ</h6>
        {% if product_types %}
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>ุงุณู ุงูููุชุฌ</th>
                    <th>ุงูุชุตููู</th>
                    <th>ุงูุฅุฌุฑุงุกุงุช</th>
                </tr>
            </thead>
            <tbody>
                {% for product in product_types %}
                <tr id="product-{{ product.id }}">
                    <td>{{ product.name }}</td>
                    <td>{{ product.category }}</td>
                    <td>
                        <button class="btn btn-sm btn-danger" onclick="deleteProductConfirm(this, '{{ product.id }}')">ุญุฐู</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="text-muted">ูู ูุชู ุฅุถุงูุฉ ุฃู ุฃุตูุงู ุจุนุฏ</p>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function deleteProductConfirm(button, productId) {
    if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูููุชุฌุ')) {
        fetch(`{{ url_for('settings.delete_product_type', product_type_id=0) }}`.replace('0', productId), {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const row = button.closest('tr');
                row.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => row.remove(), 300);
                alert('ุชู ุญุฐู ุงูููุชุฌ ุจูุฌุงุญ');
            }
        })
        .catch(error => console.error('Error:', error));
    }
}
</script>
{% endblock %}
