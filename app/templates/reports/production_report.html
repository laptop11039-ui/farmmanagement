{% extends "base.html" %}

{% block title %}ุชูุฑูุฑ ุงูุฅูุชุงุฌ{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>ุชูุฑูุฑ ุงูุฅูุชุงุฌ</h2>
    <button class="btn btn-primary" onclick="window.print()">๐จ๏ธ ุทุจุงุนุฉ</button>
</div>

{% if grouped_data %}
<!-- ููุฎุต ุงููุฌุงููุน ุญุณุจ ุงูููุชุฌ -->
<div class="card mb-4">
    <div class="card-header bg-info text-white">
        <h5 class="mb-0">๐ ููุฎุต ุงูุฅูุชุงุฌ ุญุณุจ ุงูููุชุฌ</h5>
    </div>
    <div class="card-body">
        <table class="table table-striped">
            <thead class="table-light">
                <tr>
                    <th>ุงูููุชุฌ</th>
                    <th>ุฅุฌูุงูู ุงููููุฉ</th>
                    <th>ุงููุญุฏุฉ</th>
                </tr>
            </thead>
            <tbody>
                {% for product_name, total_qty in total_by_product.items()|sort %}
                <tr class="fw-bold bg-light">
                    <td>{{ product_name }}</td>
                    <td>{{ "%.2f"|format(total_qty) }}</td>
                    <td>ูุฌู</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- ุงูุชูุงุตูู ุงููุฌูุนุฉ ุญุณุจ ุงูููุชุฌ ูุงููููุน -->
<div class="card mb-4">
    <div class="card-header bg-success text-white">
        <h5 class="mb-0">๐ ุชูุงุตูู ุงูุฅูุชุงุฌ ุญุณุจ ุงูููุชุฌ ูุงููููุน</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>ุงูููุชุฌ</th>
                        <th>ุงูุชุตููู</th>
                        <th>ุงููููุน</th>
                        <th>ุฅุฌูุงูู ุงููููุฉ</th>
                        <th>ุงููุญุฏุฉ</th>
                        <th>ุนุฏุฏ ุงูุณุฌูุงุช</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in grouped_data %}
                    <tr>
                        <td><strong>{{ item.product_name }}</strong></td>
                        <td>{{ item.category }}</td>
                        <td>{{ item.location }}</td>
                        <td><strong>{{ "%.2f"|format(item.quantity) }}</strong></td>
                        <td>{{ item.unit }}</td>
                        <td><span class="badge bg-primary">{{ item.records|length }}</span></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- ุฌููุน ุงูุณุฌูุงุช ุงูุชูุตูููุฉ -->
<div class="card">
    <div class="card-header bg-warning text-dark">
        <h5 class="mb-0">๐ ุฌููุน ุณุฌูุงุช ุงูุฅูุชุงุฌ</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                <thead class="table-light">
                    <tr>
                        <th>ุงูููุชุฌ</th>
                        <th>ุงูุชุตููู</th>
                        <th>ุงููููุน</th>
                        <th>ุงููููุฉ</th>
                        <th>ุงููุญุฏุฉ</th>
                        <th>ุงูุชุงุฑูุฎ</th>
                        <th>ููุงุญุธุงุช</th>
                    </tr>
                </thead>
                <tbody>
                    {% for production in productions %}
                    <tr>
                        <td>{{ production.product_type.name }}</td>
                        <td>{{ production.product_type.category or '-' }}</td>
                        <td>{{ production.location or '-' }}</td>
                        <td>{{ "%.2f"|format(production.quantity) }}</td>
                        <td>{{ production.unit }}</td>
                        <td>{{ production.date.strftime('%Y-%m-%d') }}</td>
                        <td>{{ production.notes or '-' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% else %}
<div class="alert alert-info">ูุง ุชูุฌุฏ ุจูุงูุงุช ุฅูุชุงุฌ</div>
{% endif %}
{% endblock %}
